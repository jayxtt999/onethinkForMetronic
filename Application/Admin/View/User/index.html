<extend name="Public/base2" />

<block name="body">


	<div class="row">
		<div class="col-md-12">
			<!-- BEGIN EXAMPLE TABLE PORTLET-->
			<div class="portlet box grey-cascade">
				<div class="portlet-title">
					<div class="caption">
						<i class="fa fa-globe"></i>用户列表
					</div>
					<div class="tools">
						<a href="javascript:;" class="collapse">
						</a>
						<a href="#portlet-config" data-toggle="modal" class="config">
						</a>
						<a href="javascript:;" class="reload">
						</a>
						<a href="javascript:;" class="remove">
						</a>
					</div>
				</div>
				<div class="portlet-body">
					<div class="table-toolbar">
						<div class="row">
							<div class="col-md-6 cf">
								<div class="fl">


									<a class="btn green" href="{:U('add')}">新 增</a>

									<button class="btn green ajax-post" url="{:U('changeStatus?method=resumeUser')}" target-form="ids">
										启 用
									</button>

									<button class="btn green ajax-post" url="{:U('changeStatus?method=forbidUser')}" target-form="ids">
										禁 用
									</button>

									<button class="btn green ajax-post" url="{:U('changeStatus?method=deleteUser')}" target-form="ids">
										删 除
									</button>

								</div>
							</div>

						</div>
					</div>
					<table class="table table-striped table-bordered table-hover" id="sample_1">
						<thead>
						<tr>
							<th class="table-checkbox">
								<input type="checkbox" class="group-checkable" data-set="#sample_1 .checkboxes"/>
							</th>
							<th>
								Username
							</th>
							<th>
								Email
							</th>
							<th>
								Points
							</th>
							<th>
								Joined
							</th>
							<th>
								Status
							</th>
						</tr>
						</thead>
						<tbody>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								shuxer
							</td>
							<td>
								<a href="mailto:shuxer@gmail.com">
									shuxer@gmail.com </a>
							</td>
							<td>
								120
							</td>
							<td class="center">
								12 Jan 2012
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								looper
							</td>
							<td>
								<a href="mailto:looper90@gmail.com">
									looper90@gmail.com </a>
							</td>
							<td>
								120
							</td>
							<td class="center">
								12.12.2011
							</td>
							<td>
									<span class="label label-sm label-warning">
									Suspended </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								userwow
							</td>
							<td>
								<a href="mailto:userwow@yahoo.com">
									userwow@yahoo.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								12.12.2012
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								user1wow
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									userwow@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								12.12.2012
							</td>
							<td>
									<span class="label label-sm label-default">
									Blocked </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								restest
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									test@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								12.12.2012
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								foopl
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									good@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								19.11.2010
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								weep
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									good@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								19.11.2010
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								coop
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									good@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								19.11.2010
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								pppol
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									good@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								19.11.2010
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								test
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									good@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								19.11.2010
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								userwow
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									userwow@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								12.12.2012
							</td>
							<td>
									<span class="label label-sm label-default">
									Blocked </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								test
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									test@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								12.12.2012
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								goop
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									good@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								12.11.2010
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								weep
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									good@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								15.11.2011
							</td>
							<td>
									<span class="label label-sm label-default">
									Blocked </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								toopl
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									good@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								16.11.2010
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								userwow
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									userwow@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								9.12.2012
							</td>
							<td>
									<span class="label label-sm label-default">
									Blocked </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								tes21t
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									test@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								14.12.2012
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								fop
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									good@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								13.11.2010
							</td>
							<td>
									<span class="label label-sm label-warning">
									Suspended </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								kop
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									good@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								17.11.2010
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								vopl
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									good@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								19.11.2010
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								userwow
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									userwow@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								12.12.2012
							</td>
							<td>
									<span class="label label-sm label-default">
									Blocked </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								wap
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									test@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								12.12.2012
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								test
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									good@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								19.12.2010
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								toop
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									good@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								17.12.2010
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						<tr class="odd gradeX">
							<td>
								<input type="checkbox" class="checkboxes" value="1"/>
							</td>
							<td>
								weep
							</td>
							<td>
								<a href="mailto:userwow@gmail.com">
									good@gmail.com </a>
							</td>
							<td>
								20
							</td>
							<td class="center">
								15.11.2011
							</td>
							<td>
									<span class="label label-sm label-success">
									Approved </span>
							</td>
						</tr>
						</tbody>
					</table>
				</div>
			</div>
			<!-- END EXAMPLE TABLE PORTLET-->
		</div>
	</div>




	<div class="row">

	<!-- 标题栏 -->
	<div class="page-title">
		<h2>用户列表</h2>
	</div>
	<div class="cf">
		<div class="fl">
            <a class="btn" href="{:U('add')}">新 增</a>
            <button class="btn ajax-post" url="{:U('changeStatus?method=resumeUser')}" target-form="ids">启 用</button>
            <button class="btn ajax-post" url="{:U('changeStatus?method=forbidUser')}" target-form="ids">禁 用</button>
            <button class="btn ajax-post confirm" url="{:U('changeStatus?method=deleteUser')}" target-form="ids">删 除</button>
        </div>

        <!-- 高级搜索 -->
		<div class="search-form fr cf">
			<div class="sleft">
				<input type="text" name="nickname" class="search-input" value="{:I('nickname')}" placeholder="请输入用户昵称或者ID">
				<a class="sch-btn" href="javascript:;" id="search" url="{:U('index')}"><i class="btn-search"></i></a>
			</div>
		</div>
    </div>
    <!-- 数据列表 -->
    <div class="data-table table-striped">
	<table class="">
    <thead>
        <tr>
		<th class="row-selected row-selected"><input class="check-all" type="checkbox"/></th>
		<th class="">UID</th>
		<th class="">昵称</th>
		<th class="">积分</th>
		<th class="">登录次数</th>
		<th class="">最后登录时间</th>
		<th class="">最后登录IP</th>
		<th class="">状态</th>
		<th class="">操作</th>
		</tr>
    </thead>
    <tbody>
		<notempty name="_list">
		<volist name="_list" id="vo">
		<tr>
            <td><input class="ids" type="checkbox" name="id[]" value="{$vo.uid}" /></td>
			<td>{$vo.uid} </td>
			<td>{$vo.nickname}</td>
			<td>{$vo.score}</td>
			<td>{$vo.login}</td>
			<td><span>{$vo.last_login_time|time_format}</span></td>
			<td><span>{:long2ip($vo['last_login_ip'])}</span></td>
			<td>{$vo.status_text}</td>
			<td><eq name="vo.status" value="1">
				<a href="{:U('User/changeStatus?method=forbidUser&id='.$vo['uid'])}" class="ajax-get">禁用</a>
				<else/>
				<a href="{:U('User/changeStatus?method=resumeUser&id='.$vo['uid'])}" class="ajax-get">启用</a>
				</eq>
				<a href="{:U('AuthManager/group?uid='.$vo['uid'])}" class="authorize">授权</a>
                <a href="{:U('User/changeStatus?method=deleteUser&id='.$vo['uid'])}" class="confirm ajax-get">删除</a>
                </td>
		</tr>
		</volist>
		<else/>
		<td colspan="9" class="text-center"> aOh! 暂时还没有内容! </td>
		</notempty>
	</tbody>
    </table>
	</div>
    <div class="page">
        {$_page}
    </div>

	</div>
</block>

<block name="script">
	<script src="__STATIC__/thinkbox/jquery.thinkbox.js"></script>

	<script type="text/javascript">
	//搜索功能
	$("#search").click(function(){
		var url = $(this).attr('url');
        var query  = $('.search-form').find('input').serialize();
        query = query.replace(/(&|^)(\w*?\d*?\-*?_*?)*?=?((?=&)|(?=$))/g,'');
        query = query.replace(/^&/g,'');
        if( url.indexOf('?')>0 ){
            url += '&' + query;
        }else{
            url += '?' + query;
        }
		window.location.href = url;
	});
	//回车搜索
	$(".search-input").keyup(function(e){
		if(e.keyCode === 13){
			$("#search").click();
			return false;
		}
	});
    //导航高亮
	jQuery(document).ready(function() {

		var table = $('#sample_1');
		// begin first table
		table.dataTable({
			"columns": [{
				"orderable": false
			}, {
				"orderable": true
			}, {
				"orderable": false
			}, {
				"orderable": false
			}, {
				"orderable": true
			}, {
				"orderable": false
			}],
			"lengthMenu": [
				[5, 15, 20, -1],
				[5, 15, 20, "All"] // change per page values here
			],
			// set the initial value
			"pageLength": 5,
			"pagingType": "bootstrap_full_number",
			"language": {
				"lengthMenu": "  _MENU_ records",
				"paginate": {
					"previous":"Prev",
					"next": "Next",
					"last": "Last",
					"first": "First"
				}
			},
			"columnDefs": [{  // set default column settings
				'orderable': false,
				'targets': [0]
			}, {
				"searchable": false,
				"targets": [0]
			}],
			"order": [
				[1, "asc"]
			] // set first column as a default sort by asc
		});

		var tableWrapper = jQuery('#sample_1_wrapper');

		table.find('.group-checkable').change(function () {
			var set = jQuery(this).attr("data-set");
			var checked = jQuery(this).is(":checked");
			jQuery(set).each(function () {
				if (checked) {
					$(this).attr("checked", true);
					$(this).parents('tr').addClass("active");
				} else {
					$(this).attr("checked", false);
					$(this).parents('tr').removeClass("active");
				}
			});
			jQuery.uniform.update(set);
		});

		table.on('change', 'tbody tr .checkboxes', function () {
			$(this).parents('tr').toggleClass("active");
		});

		tableWrapper.find('.dataTables_length select').addClass("form-control input-xsmall input-inline");
	});
	</script>
</block>
